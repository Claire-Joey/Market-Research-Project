{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import requests\n",
    "import json"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "os.chdir('/Users/clairesun/desktop')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ds = pd.read_json('google3.json',lines=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "channelGrouping          object\n",
       "customDimensions         object\n",
       "date                      int64\n",
       "device                   object\n",
       "fullVisitorId           float64\n",
       "geoNetwork               object\n",
       "hits                     object\n",
       "socialEngagementType     object\n",
       "totals                   object\n",
       "trafficSource            object\n",
       "visitId                   int64\n",
       "visitNumber               int64\n",
       "visitStartTime            int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ds.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>fullVisitorId</th>\n",
       "      <th>visitId</th>\n",
       "      <th>visitNumber</th>\n",
       "      <th>visitStartTime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>2556.0</td>\n",
       "      <td>2.556000e+03</td>\n",
       "      <td>2.556000e+03</td>\n",
       "      <td>2556.000000</td>\n",
       "      <td>2.556000e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>20170801.0</td>\n",
       "      <td>4.549451e+18</td>\n",
       "      <td>1.501614e+09</td>\n",
       "      <td>2.661189</td>\n",
       "      <td>1.501614e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>0.0</td>\n",
       "      <td>3.107969e+18</td>\n",
       "      <td>2.280455e+04</td>\n",
       "      <td>12.022200</td>\n",
       "      <td>2.280423e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>20170801.0</td>\n",
       "      <td>3.458418e+15</td>\n",
       "      <td>1.501570e+09</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.501571e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>20170801.0</td>\n",
       "      <td>1.627093e+18</td>\n",
       "      <td>1.501597e+09</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.501597e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>20170801.0</td>\n",
       "      <td>4.466389e+18</td>\n",
       "      <td>1.501614e+09</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.501614e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>20170801.0</td>\n",
       "      <td>7.350971e+18</td>\n",
       "      <td>1.501632e+09</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.501632e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>20170801.0</td>\n",
       "      <td>9.997536e+18</td>\n",
       "      <td>1.501657e+09</td>\n",
       "      <td>326.000000</td>\n",
       "      <td>1.501657e+09</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             date  fullVisitorId       visitId  visitNumber  visitStartTime\n",
       "count      2556.0   2.556000e+03  2.556000e+03  2556.000000    2.556000e+03\n",
       "mean   20170801.0   4.549451e+18  1.501614e+09     2.661189    1.501614e+09\n",
       "std           0.0   3.107969e+18  2.280455e+04    12.022200    2.280423e+04\n",
       "min    20170801.0   3.458418e+15  1.501570e+09     1.000000    1.501571e+09\n",
       "25%    20170801.0   1.627093e+18  1.501597e+09     1.000000    1.501597e+09\n",
       "50%    20170801.0   4.466389e+18  1.501614e+09     1.000000    1.501614e+09\n",
       "75%    20170801.0   7.350971e+18  1.501632e+09     2.000000    1.501632e+09\n",
       "max    20170801.0   9.997536e+18  1.501657e+09   326.000000    1.501657e+09"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ds.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>channelGrouping</th>\n",
       "      <th>customDimensions</th>\n",
       "      <th>date</th>\n",
       "      <th>device</th>\n",
       "      <th>fullVisitorId</th>\n",
       "      <th>geoNetwork</th>\n",
       "      <th>hits</th>\n",
       "      <th>socialEngagementType</th>\n",
       "      <th>totals</th>\n",
       "      <th>trafficSource</th>\n",
       "      <th>visitId</th>\n",
       "      <th>visitNumber</th>\n",
       "      <th>visitStartTime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Organic Search</td>\n",
       "      <td>[]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>2.248282e+18</td>\n",
       "      <td>{'continent': 'Americas', 'subContinent': 'Car...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '3', ...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'campaign': '(not set)', 'source': '(direct)'...</td>\n",
       "      <td>1501583974</td>\n",
       "      <td>1</td>\n",
       "      <td>1501583974</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Organic Search</td>\n",
       "      <td>[{'index': '4', 'value': 'North America'}]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>8.647436e+18</td>\n",
       "      <td>{'continent': 'Americas', 'subContinent': 'Nor...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '12',...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'campaign': '(not set)', 'source': '(direct)'...</td>\n",
       "      <td>1501616585</td>\n",
       "      <td>1</td>\n",
       "      <td>1501616585</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Organic Search</td>\n",
       "      <td>[{'index': '4', 'value': 'APAC'}]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>2.055840e+18</td>\n",
       "      <td>{'continent': 'Asia', 'subContinent': 'Souther...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '3', ...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'campaign': '(not set)', 'source': '(direct)'...</td>\n",
       "      <td>1501583344</td>\n",
       "      <td>1</td>\n",
       "      <td>1501583344</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Direct</td>\n",
       "      <td>[{'index': '4', 'value': 'EMEA'}]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>7.508461e+17</td>\n",
       "      <td>{'continent': 'Europe', 'subContinent': 'Weste...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '0', ...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'campaign': '(not set)', 'source': '(direct)'...</td>\n",
       "      <td>1501573386</td>\n",
       "      <td>1</td>\n",
       "      <td>1501573386</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Organic Search</td>\n",
       "      <td>[{'index': '4', 'value': 'North America'}]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>5.734272e+17</td>\n",
       "      <td>{'continent': 'Americas', 'subContinent': 'Nor...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '22',...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'campaign': '(not set)', 'source': '(direct)'...</td>\n",
       "      <td>1501651467</td>\n",
       "      <td>8</td>\n",
       "      <td>1501651467</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Referral</td>\n",
       "      <td>[]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>8.313021e+18</td>\n",
       "      <td>{'continent': 'Asia', 'subContinent': 'Southea...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '11',...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'referralPath': '/imgres', 'campaign': '(not ...</td>\n",
       "      <td>1501611552</td>\n",
       "      <td>1</td>\n",
       "      <td>1501611552</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Organic Search</td>\n",
       "      <td>[{'index': '4', 'value': 'North America'}]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>9.161549e+18</td>\n",
       "      <td>{'continent': 'Americas', 'subContinent': 'Nor...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '8', ...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'campaign': '(not set)', 'source': '(direct)'...</td>\n",
       "      <td>1501600400</td>\n",
       "      <td>2</td>\n",
       "      <td>1501600400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Organic Search</td>\n",
       "      <td>[{'index': '4', 'value': 'APAC'}]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>7.712738e+18</td>\n",
       "      <td>{'continent': 'Asia', 'subContinent': 'Southea...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '19',...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'campaign': '(not set)', 'source': '(direct)'...</td>\n",
       "      <td>1501640178</td>\n",
       "      <td>1</td>\n",
       "      <td>1501640178</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Referral</td>\n",
       "      <td>[{'index': '4', 'value': 'North America'}]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>6.644155e+18</td>\n",
       "      <td>{'continent': 'Americas', 'subContinent': 'Nor...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '4', ...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'referralPath': '/', 'campaign': '(not set)',...</td>\n",
       "      <td>1501585492</td>\n",
       "      <td>3</td>\n",
       "      <td>1501585492</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Organic Search</td>\n",
       "      <td>[{'index': '4', 'value': 'North America'}]</td>\n",
       "      <td>20170801</td>\n",
       "      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>\n",
       "      <td>2.485029e+18</td>\n",
       "      <td>{'continent': 'Americas', 'subContinent': 'Nor...</td>\n",
       "      <td>[{'hitNumber': '1', 'time': '0', 'hour': '18',...</td>\n",
       "      <td>Not Socially Engaged</td>\n",
       "      <td>{'visits': '1', 'hits': '1', 'pageviews': '1',...</td>\n",
       "      <td>{'campaign': '(not set)', 'source': '(direct)'...</td>\n",
       "      <td>1501635646</td>\n",
       "      <td>1</td>\n",
       "      <td>1501635646</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  channelGrouping                            customDimensions      date  \\\n",
       "0  Organic Search                                          []  20170801   \n",
       "1  Organic Search  [{'index': '4', 'value': 'North America'}]  20170801   \n",
       "2  Organic Search           [{'index': '4', 'value': 'APAC'}]  20170801   \n",
       "3          Direct           [{'index': '4', 'value': 'EMEA'}]  20170801   \n",
       "4  Organic Search  [{'index': '4', 'value': 'North America'}]  20170801   \n",
       "5        Referral                                          []  20170801   \n",
       "6  Organic Search  [{'index': '4', 'value': 'North America'}]  20170801   \n",
       "7  Organic Search           [{'index': '4', 'value': 'APAC'}]  20170801   \n",
       "8        Referral  [{'index': '4', 'value': 'North America'}]  20170801   \n",
       "9  Organic Search  [{'index': '4', 'value': 'North America'}]  20170801   \n",
       "\n",
       "                                              device  fullVisitorId  \\\n",
       "0  {'browser': 'Chrome', 'browserVersion': 'not a...   2.248282e+18   \n",
       "1  {'browser': 'Chrome', 'browserVersion': 'not a...   8.647436e+18   \n",
       "2  {'browser': 'Chrome', 'browserVersion': 'not a...   2.055840e+18   \n",
       "3  {'browser': 'Chrome', 'browserVersion': 'not a...   7.508461e+17   \n",
       "4  {'browser': 'Chrome', 'browserVersion': 'not a...   5.734272e+17   \n",
       "5  {'browser': 'Chrome', 'browserVersion': 'not a...   8.313021e+18   \n",
       "6  {'browser': 'Chrome', 'browserVersion': 'not a...   9.161549e+18   \n",
       "7  {'browser': 'Chrome', 'browserVersion': 'not a...   7.712738e+18   \n",
       "8  {'browser': 'Chrome', 'browserVersion': 'not a...   6.644155e+18   \n",
       "9  {'browser': 'Chrome', 'browserVersion': 'not a...   2.485029e+18   \n",
       "\n",
       "                                          geoNetwork  \\\n",
       "0  {'continent': 'Americas', 'subContinent': 'Car...   \n",
       "1  {'continent': 'Americas', 'subContinent': 'Nor...   \n",
       "2  {'continent': 'Asia', 'subContinent': 'Souther...   \n",
       "3  {'continent': 'Europe', 'subContinent': 'Weste...   \n",
       "4  {'continent': 'Americas', 'subContinent': 'Nor...   \n",
       "5  {'continent': 'Asia', 'subContinent': 'Southea...   \n",
       "6  {'continent': 'Americas', 'subContinent': 'Nor...   \n",
       "7  {'continent': 'Asia', 'subContinent': 'Southea...   \n",
       "8  {'continent': 'Americas', 'subContinent': 'Nor...   \n",
       "9  {'continent': 'Americas', 'subContinent': 'Nor...   \n",
       "\n",
       "                                                hits  socialEngagementType  \\\n",
       "0  [{'hitNumber': '1', 'time': '0', 'hour': '3', ...  Not Socially Engaged   \n",
       "1  [{'hitNumber': '1', 'time': '0', 'hour': '12',...  Not Socially Engaged   \n",
       "2  [{'hitNumber': '1', 'time': '0', 'hour': '3', ...  Not Socially Engaged   \n",
       "3  [{'hitNumber': '1', 'time': '0', 'hour': '0', ...  Not Socially Engaged   \n",
       "4  [{'hitNumber': '1', 'time': '0', 'hour': '22',...  Not Socially Engaged   \n",
       "5  [{'hitNumber': '1', 'time': '0', 'hour': '11',...  Not Socially Engaged   \n",
       "6  [{'hitNumber': '1', 'time': '0', 'hour': '8', ...  Not Socially Engaged   \n",
       "7  [{'hitNumber': '1', 'time': '0', 'hour': '19',...  Not Socially Engaged   \n",
       "8  [{'hitNumber': '1', 'time': '0', 'hour': '4', ...  Not Socially Engaged   \n",
       "9  [{'hitNumber': '1', 'time': '0', 'hour': '18',...  Not Socially Engaged   \n",
       "\n",
       "                                              totals  \\\n",
       "0  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "1  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "2  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "3  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "4  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "5  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "6  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "7  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "8  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "9  {'visits': '1', 'hits': '1', 'pageviews': '1',...   \n",
       "\n",
       "                                       trafficSource     visitId  visitNumber  \\\n",
       "0  {'campaign': '(not set)', 'source': '(direct)'...  1501583974            1   \n",
       "1  {'campaign': '(not set)', 'source': '(direct)'...  1501616585            1   \n",
       "2  {'campaign': '(not set)', 'source': '(direct)'...  1501583344            1   \n",
       "3  {'campaign': '(not set)', 'source': '(direct)'...  1501573386            1   \n",
       "4  {'campaign': '(not set)', 'source': '(direct)'...  1501651467            8   \n",
       "5  {'referralPath': '/imgres', 'campaign': '(not ...  1501611552            1   \n",
       "6  {'campaign': '(not set)', 'source': '(direct)'...  1501600400            2   \n",
       "7  {'campaign': '(not set)', 'source': '(direct)'...  1501640178            1   \n",
       "8  {'referralPath': '/', 'campaign': '(not set)',...  1501585492            3   \n",
       "9  {'campaign': '(not set)', 'source': '(direct)'...  1501635646            1   \n",
       "\n",
       "   visitStartTime  \n",
       "0      1501583974  \n",
       "1      1501616585  \n",
       "2      1501583344  \n",
       "3      1501573386  \n",
       "4      1501651467  \n",
       "5      1501611552  \n",
       "6      1501600400  \n",
       "7      1501640178  \n",
       "8      1501585492  \n",
       "9      1501635646  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ds.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "ds.to_csv ('export_dataframe.csv', index = False, header=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
